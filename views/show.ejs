<% layout('layouts/boilerplate')%>


<div class="row py-5 my-5 mx-4">

<!-- left column -->
<div class="col-md-6">

<!-- image -->
    <% for (let img of p.images) { %>
  <container>  <img src="<%= img.url %>" style="max-width:450px; width:100%"> </container>
    <% break } %>   

</div>

<!-- right column -->
<div class="col-md-6">

<!-- main detail section -->
    <div class="container pt-5" style="max-width: 100vw;">
        <div class="card-body pb-4">

            <p class='fw-bold'> <%= p.artist %> </p>

          <p class="">
                <span class="fw-bold fst-italic">
                    <%= p.title %>,
                </span>
                <span class="">
                    <% for (let y of p.year) { %>
                        <% if (y.year_started != undefined || y.year_stared != null){ %>
                            <%= `${y.year_started} - ${y.year_finished}` %> 
                    <%  } else { %>
                        <td><%= y.year_finished %></td>
                        <% } %>
                    <% break } %>
                </span>
            </p>




            <p class="card-subtitle mb-2 text-muted"> 
                
                <%= p.medium  %>,
               
                        <% for (let s of p.size) { %>
                        <% if ((s.z === undefined) || (s.z === null)){ %>
                             <%=  `${s.x} x ${s.x} ${s.unit}` %> 
                    <%  } else { %>
                        <%=  `${s.x} x ${s.y} x ${s.z} ${s.unit}` %>
                        <% } %>
                    <% break } %>

        
            </p>
        </div>
        <div>
          <p class="accordion pb-2" data-bs-toggle="collapse" id="description_accordion" href="#collapseTwo"> Description &#9660; </p> 
            <div id="collapseTwo" class="collapse container pb-4" data-bs-parent="#description_accordion">
                <%= p.description  %> 
            </div>
        </div>
        <!-- ownership details section -->
            <div id="">

                <p class="accordion pb-2" data-bs-toggle="collapse" id="owner_detail_accordion" href="#collapseOne"> Ownership Details &#9660; </p>

                <div id="collapseOne" class="collapse container pb-4" data-bs-parent="#owner_detail_accordion">
                    <div class="row">
                        <div class="col-md-9 pb-4">
                            <% for (let o of p.owner ) { %> 
                            <%    if ( o.name !== undefined && o.name !== '') {%>
                                <% if (o.contact_info !== '') { %> 
                                    <div> <%= `Owner: ${o.name}` %> <br>
                                    <%= `Owner contact: ${o.contact_info}` %> </div>
                                <% } else { %>
                                    <p> <%= `Owner: ${o.name}` %> </p>  
                                    <% } %>
                                        <% } else { %>
                                    <p> No info on owner </p > %>
                                        <% } %>
                            <% break } %>
                            <p></p>

                            <!-- if logged user === the owner ;;; add functionality to the form check "I'm the owner"-->
                            <% if (p.acquiration_date !== false) { %>
                            <p> Acquiration date: <%=  moment(p.acquiration_date).format("DD/MM/YYYY") %></p>
                            <% } %>
                            
                        <% if (p.holder !== p.owner){ %>
                            <% for (let h of p.holder ) { %> 
                                <%    if ( h.name !== undefined && h.name !== '') {%>
                                    <% if (h.contact_info !== '') { %> 
                                        <div> <%= `Holder: ${h.name}` %> &emsp; %> <br>
                                            <%= `Holder contact: ${h.contact_info}` %> </div>
                                    <% } else { %>
                                        <p> <%= `Holder: ${h.name}` %> </p>  
                                        <% } %>
                                            <% } else { %>
                                        <p> No info on holder </p > %>
                                            <% } %>
                                <% break } %>

                        <% } %>

                        <% if (p.catalogue !== false) {%>
                            <p>External catalogue id: <br> <%= p.catalogue %> </p>
                            <% } %>
                            

                        </div>
                        <div class="col-md-3">

                            <!-- Details: Archival - check/unckecked; On sale - checked/unchecked; -->
                        <!-- bug: cannot r87ead vjalue  -->
                            <p> Archival: <% if (p.archival == true) { %> &#10003; <% } else { %> &#10007; <% } %>

                            <% if (p.forSale == true) { %>
                                <p> For Sale: &#10003; </p> 
                                <p> Price: <% for (let d of p.price) { %> <%= `${d.price} ${d.currency}` %> <% } %>
                                     <% } else { %>
                                        <p> For Sale: &#10007; </p> 
                                        <% } %> 


                           
                                
                                <!-- ; added: - timestamp -->

                        </div>



                </div>

            </div>

            <!-- Details -->

          <a href="/collection/show/<%= p._id %>/edit" class="card-link">Edit Piece</a>
          <br><br>
          <a href="#" class="card-link">Export (work in progress)</a>
        </div>
      </div>



</div>

</div>